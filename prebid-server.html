<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Prebid Server</title>
    <script async src="//clickiocmp.com/t/consent_236053.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/video.js/7.20.3/video-js.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/videojs-ima/2.1.0/videojs.ima.css" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: system-ui, -apple-system, sans-serif;
            background: #f0f2f5;
            color: #1c1e21;
            line-height: 1.5;
        }

        .site-header {
            background: linear-gradient(90deg, #4267B2, #5B7BD5);
            padding: 15px 0;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .logo {
            font-size: 24px;
            font-weight: 600;
            color: white;
            text-decoration: none;
        }

        .nav-link {
            color: white;
            text-decoration: none;
            margin-left: 20px;
            opacity: 0.9;
            transition: opacity 0.2s;
        }

        .nav-link:hover {
            opacity: 1;
        }

        .main-content {
            margin-top: 60px;
            padding-top: 20px;
            padding-bottom: 130px;
        }

        .content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .page-title {
            text-align: center;
            margin: 40px 0;
            font-size: 32px;
            color: #1c1e21;
        }

        .section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin: 30px auto;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            max-width: 1000px;
        }

        .section-title {
            font-size: 24px;
            margin-bottom: 15px;
            color: #1c1e21;
        }

        .section-text {
            color: #65676b;
            margin-bottom: 20px;
            font-size: 16px;
            line-height: 1.6;
        }

        .ad-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 20px auto;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            max-width: 1000px;
        }

        .ad-label {
            font-size: 12px;
            color: #65676b;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .native-ad {
            padding: 15px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .native-ad img {
            width: 100%;
            height: auto;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .native-ad-title {
            font-size: 18px;
            font-weight: bold;
            color: #1c1e21;
            margin-bottom: 10px;
        }

        .native-ad-desc {
            font-size: 14px;
            color: #65676b;
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .native-ad-cta {
            display: inline-block;
            padding: 8px 20px;
            background: #4267B2;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            transition: background-color 0.2s;
        }

        .native-ad-cta:hover {
            background: #365899;
        }

        .footer-ad {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            height: 110px;
            z-index: 1000;
        }

        .close-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 20px;
            color: #65676b;
            cursor: pointer;
            padding: 5px;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: 0.2s ease;
        }

        .close-button:hover {
            background: #f0f2f5;
        }

        #status-panel {
            position: fixed;
            bottom: 130px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            font-size: 14px;
            z-index: 1000;
            backdrop-filter: blur(10px);
            transition: opacity 0.3s ease;
            opacity: 1;
        }

        #status-panel.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        .video-player-wrapper {
            position: relative;
            width: 100%;
            max-width: 640px;
            margin: 0 auto;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .video-js {
            border-radius: 8px;
        }

        .hidden {
            display: none;
        }
    </style>
</head>

<body>
    <header class="site-header">
        <div class="header-content">
            <a href="#" class="logo">Prebid Test</a>
            <nav>
                <a href="#guide" class="nav-link">Guide d'intégration</a>
                <a href="#documentation" class="nav-link">Documentation</a>
            </nav>
        </div>
    </header>

    <div class="main-content">
        <div class="content">
            <div class="ad-container">
                <div class="ad-label">Header Ad (728x90)</div>
                <div id="header-ad"></div>
            </div>

            <h1 class="page-title">Page de test Prebid Server</h1>

            <section class="section">
                <h2 class="section-title">À propos de cette page</h2>
                <p class="section-text">
                    Cette page de test vous permet de vérifier l'intégration de Prebid Server dans votre environnement.
                    Elle simule différents types de formats publicitaires (bannière, native, vidéo) et vous aide à
                    valider votre configuration.
                </p>
            </section>

            <div class="ad-container">
                <div class="ad-label">Banner Ad (728x90)</div>
                <div id="banner-ad"></div>
            </div>

            <section class="section">
                <h2 class="section-title">Formats Publicitaires Disponibles</h2>
                <p class="section-text">
                    Nous prenons en charge plusieurs formats publicitaires pour répondre à vos besoins :
                </p>
                <ul>
                    <li>Bannières display standards (728x90, 300x250, etc.)</li>
                    <li>Publicités natives personnalisables</li>
                    <li>Publicités vidéo instream et outstream</li>
                    <li>Formats rich media</li>
                </ul>
            </section>

            <div class="ad-container">
                <div class="ad-container native-container">
                    <div class="ad-label">Native Ad</div>
                    <div id="native-ad"></div>
                </div>

                <!-- Template for Native Ad -->
                <template class="native-ad-template">
                    <div class="native-ad">
                        <img class="native-ad-image" src="" alt="">
                        <div class="native-ad-title"></div>
                        <div class="native-ad-desc"></div>
                        <a class="native-ad-cta" href="" target="_blank"></a>
                    </div>
                </template>
            </div>

            <section class="section">
                <h2 class="section-title">Intégration Vidéo</h2>
                <p class="section-text">
                    Notre solution vidéo utilise le Google IMA SDK pour une expérience publicitaire optimale.
                    Le player ci-dessous démontre l'intégration d'une publicité pre-roll avec possibilité de skip.
                </p>
            </section>

            <div class="ad-container">
                <div class="ad-label">Video Ad</div>
                <div id="video-ad">
                    <div class="video-player-wrapper">
                        <video id="video-player" class="video-js vjs-default-skin" controls preload="auto" width="640"
                            height="360">
                        </video>
                    </div>
                </div>
            </div>

            <section class="section">
                <h2 class="section-title">Panel de Debug</h2>
                <p class="section-text">
                    Le panel de statut en bas à droite affiche des informations en temps réel sur :
                </p>
                <ul>
                    <li>Le statut de chargement des publicités</li>
                    <li>La latence des requêtes</li>
                    <li>Les éventuelles erreurs</li>
                </ul>
            </section>
        </div>
    </div>

    <div class="footer-ad" id="footer-ad-container">
        <button class="close-button"
            onclick="document.getElementById('footer-ad-container').classList.add('hidden')">×</button>
        <div class="ad-container" style="margin: 0; box-shadow: none;">
            <div class="ad-label">Footer Ad (728x90)</div>
            <div id="footer-ad"></div>
        </div>
    </div>

    <div id="status-panel">
        <div>Status: <span id="status">En attente du consentement...</span></div>
        <div>Latence: <span id="latency">-</span></div>
    </div>

    <!-- Video.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/video.js/7.20.3/video.min.js"></script>
    <!-- Plugin Videojs Contrib Ads (OBLIGATOIRE pour utiliser videojs-ima) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-contrib-ads/6.9.0/videojs-contrib-ads.min.js"></script>
    <!-- IMA SDK -->
    <script src="https://imasdk.googleapis.com/js/sdkloader/ima3.js"></script>
    <!-- VideoJS-IMA -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-ima/2.1.0/videojs.ima.min.js"></script>

    <script>
        class PrebidServerTest {
            constructor() {
                this.endpoints = {
                    auction: 'https://am-prebid.bliink.io/openrtb2/auction'
                };
                this.adUnits = {
                    'header-ad': {
                        tagid: 'TELELOISIRS_HEADER',
                        type: 'banner',
                        sizes: [[728, 90]]
                    },
                    'banner-ad': {
                        tagid: 'TELELOISIRS_ARTICLE',
                        type: 'banner',
                        sizes: [[728, 90]]
                    },
                    'native-ad': {
                        tagid: 'TELELOISIRS_ARTICLE',
                        type: 'native',
                        nativeConfig: {
                            title: { required: true, len: 80 },
                            image: { required: true, sizes: [1200, 627] },
                            sponsoredBy: { required: true },
                            clickUrl: { required: true },
                            body: { required: true },
                            cta: { required: true }
                        }
                    },
                    'video-ad': {
                        tagid: 'TELELOISIRS_FOOTER',
                        type: 'video',
                        playerSize: [640, 360],
                        context: 'instream',
                        mimes: ['video/mp4', 'video/webm'],
                        protocols: [2, 3, 5, 6],
                        api: [2],
                        maxduration: 30,
                        linearity: 1,
                        skip: 1
                    },
                    'footer-ad': {
                        tagid: 'TELELOISIRS_FOOTER',
                        type: 'banner',
                        sizes: [[728, 90]]
                    }
                };
                this.initTime = Date.now();
                this.videoPlayer = null;
                this.statusPanelTimeout = null;
            }

            async init() {
                this.updateStatus('Vérification du consentement...');
                if (typeof window.__tcfapi !== 'function') {
                    this.updateStatus('Erreur: CMP non disponible', true);
                    return;
                }

                try {
                    const tcData = await this.getTCFConsent();
                    await this.setupVideoPlayer();
                    this.updateStatus('Consentement obtenu, envoi de la requête...');
                    await this.requestAds(tcData);
                } catch (error) {
                    this.updateStatus(`Erreur: ${error.message}`, true);
                    console.error(error);
                }
            }
            getBannerSizes() {
                const width = window.innerWidth;
                // En mobile (<768px), on utilise 300x250 ou 320x50
                if (width < 768) {
                    return [[300, 250], [320, 50]];
                }
                // Sinon on garde les formats standards
                return [[728, 90]];
            }

            async initVideoPlayer() {
                return new Promise((resolve) => {
                    if (document.readyState === 'complete') {
                        this.setupVideoPlayer().then(resolve);
                    } else {
                        window.addEventListener('load', () => {
                            this.setupVideoPlayer().then(resolve);
                        });
                    }
                });
            }


            async setupVideoPlayer() {
                return new Promise((resolve, reject) => {
                    if (typeof videojs === 'undefined') {
                        reject(new Error("VideoJS n'est pas chargé."));
                        return;
                    }

                    const player = videojs('video-player', {
                        controls: true,
                        fluid: true,
                        preload: 'auto'
                    });

                    player.ready(() => {
                        if (typeof google === 'undefined' || !google.ima) {
                            console.error('IMA SDK non chargé.');
                            resolve();
                            return;
                        }

                        const imaOptions = {
                            id: 'video-player',
                            adTagUrl: '', // Ad tag initial (sera mis à jour dans renderMockAd)
                            debug: true,
                            loadVideoTimeout: 6000,
                            vpaidMode: google.ima.ImaSdkSettings.VpaidMode.ENABLED
                        };

                        player.ima(imaOptions);
                        this.videoPlayer = player;

                        player.on('ads-error', (err) => {
                            console.error('Erreur de publicité:', err);
                        });

                        player.on('error', (e) => {
                            console.error('Erreur du lecteur vidéo:', e);
                        });

                        resolve();
                    });
                });
            }

            getTCFConsent() {
                return new Promise((resolve, reject) => {
                    window.__tcfapi('getTCData', 2, (tcData, success) => {
                        if (success) {
                            resolve(tcData);
                        } else {
                            reject(new Error('Impossible d\'obtenir le consentement'));
                        }
                    });
                });
            }

            buildRequest(tcData) {
                const domain = window.location.hostname;
                return {
                    id: `request-${Date.now()}`,
                    cur: ['EUR'],
                    ssp: "ss-DailyMotion",
                    imp: Object.entries(this.adUnits).map(([id, unit]) => {
                        const imp = {
                            id,
                            tagid: unit.tagid,
                            bidfloor: 0.01,
                            bidfloorcur: "USD",
                            secure: 1,
                            ext: {
                                data: {
                                    gpid: `${id}-slot`,
                                    tagid: unit.tagid
                                },
                                prebid: {
                                    bidder: {
                                        bliink: {
                                            publisherId: 1,
                                            adSlot: `${id}-slot`,
                                            tagId: unit.tagid,
                                            imageUrl: "http://sample-image.io"
                                        }
                                    },
                                    adunitcode: id
                                }
                            }
                        };

                        // Add format-specific configurations
                        switch (unit.type) {
                            case 'banner':
                                imp.banner = {
                                    topframe: 1,
                                    format: this.getBannerSizes().map(([w, h]) => ({ w, h }))
                                };
                                break;
                            case 'native':
                                imp.native = {
                                    request: JSON.stringify({
                                        ver: "1.2",
                                        assets: [
                                            {
                                                id: 1,
                                                required: 1,
                                                title: { len: 80 }
                                            },
                                            {
                                                id: 2,
                                                required: 1,
                                                img: {
                                                    type: 3,
                                                    w: 1200,
                                                    h: 627
                                                }
                                            },
                                            {
                                                id: 3,
                                                required: 1,
                                                data: {
                                                    type: 1,
                                                    len: 200
                                                }
                                            },
                                            {
                                                id: 4,
                                                required: 1,
                                                data: {
                                                    type: 2,
                                                    len: 50
                                                }
                                            },
                                            {
                                                id: 5,
                                                required: 1,
                                                data: {
                                                    type: 12,
                                                    len: 20
                                                }
                                            }
                                        ]
                                    })
                                };
                                break;
                            case 'video':
                                imp.video = {
                                    mimes: unit.mimes,
                                    minduration: 1,
                                    maxduration: unit.maxduration,
                                    protocols: unit.protocols,
                                    w: unit.playerSize[0],
                                    h: unit.playerSize[1],
                                    startdelay: 0,
                                    placement: 1,
                                    skip: unit.skip,
                                    skipmin: 5,
                                    skipafter: 5,
                                    playbackmethod: [2],
                                    api: unit.api
                                };
                                break;
                        }

                        return imp;
                    }),
                    site: {
                        domain: domain,
                        publisher: {
                            domain: domain,
                            id: "1"
                        },
                        page: window.location.href
                    },
                    device: {
                        w: window.innerWidth,
                        h: window.innerHeight,
                        dnt: navigator.doNotTrack === "1" ? 1 : 0,
                        ua: navigator.userAgent,
                        language: navigator.language,
                        "ip": "188.65.124.0",
                        ext: {
                            vpw: document.documentElement.clientWidth,
                            vph: document.documentElement.clientHeight
                        },
                        devicetype: 2,
                        os: this.getOS(),
                        osv: this.getOSVersion()
                    },
                    user: {
                        ext: {
                            consent: tcData.tcString,
                            ConsentedProvidersSettings: tcData.addtlConsent ? {
                                consented_providers: tcData.addtlConsent
                            } : undefined
                        }
                    },
                    regs: {
                        ext: {
                            gdpr: 0
                        }
                    },
                    test: 0,
                    ext: {
                        prebid: {
                            auctiontimestamp: Date.now(),
                            targeting: {
                                includewinners: true,
                                includebidderkeys: false
                            },
                            channel: {
                                name: "pbjs",
                                version: "v9.24.0-pre"
                            },
                            createtids: false
                        },
                        tmaxmax: 2000
                    },
                    tmax: 1000
                };
            }

            async requestAds(tcData) {
                const request = this.buildRequest(tcData);

                try {
                    const response = await fetch(this.endpoints.auction, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(request)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    let data = await response.json();

                    // MOCK: Ajouter des réponses mock pour native et video si nécessaire
                    const isDev = window.location.hostname === 'localhost' ||
                        window.location.hostname === '127.0.0.1';
                    if (isDev) {
                        data = this.addMockResponses(data);
                    }

                    this.displayLatency();
                    this.renderAds(data.seatbid);
                    this.updateStatus('Publicités chargées avec succès');
                } catch (error) {
                    this.updateStatus(`Erreur lors de la requête: ${error.message}`, true);
                }
            }


            renderAds(seatbid) {
                if (!seatbid || !seatbid.length) return;

                seatbid.forEach(seat => {
                    seat.bid.forEach(bid => {
                        const adUnit = this.adUnits[bid.impid];
                        if (!adUnit) return;

                        // Si c'est une réponse native ou vidéo, on utilise un mock
                        if (adUnit.type === 'native' || adUnit.type === 'video') {
                            this.renderMockAd(bid.impid, adUnit.type);
                        } else {
                            // Pour les bannières, on utilise la réponse du serveur
                            this.renderBanner(bid);
                        }
                    });
                });
            }

            renderMockAd(impid, type) {
                if (type === 'native') {
                    const mockNative = {
                        assets: [
                            { title: { text: "Publicité Native de Test" } },
                            { img: { url: "https://placehold.co/1200x627", w: 1200, h: 627 } },
                            { data: { value: "Description de test pour la publicité native" } },
                            { data: { value: "Brand Test" } },
                            { data: { value: "En savoir plus" } }
                        ],
                        link: { url: "https://example.com" }
                    };

                    const container = document.getElementById(impid);
                    if (container) {
                        const template = document.querySelector('.native-ad-template');
                        if (template) {
                            const content = template.content.cloneNode(true);
                            const ad = content.querySelector('.native-ad');

                            ad.querySelector('.native-ad-image').src = mockNative.assets[1].img.url;
                            ad.querySelector('.native-ad-title').textContent = mockNative.assets[0].title.text;
                            ad.querySelector('.native-ad-desc').textContent = mockNative.assets[2].data.value;

                            const cta = ad.querySelector('.native-ad-cta');
                            cta.textContent = mockNative.assets[4].data.value;
                            cta.href = mockNative.link.url;

                            container.innerHTML = '';
                            container.appendChild(content);
                        } else {
                            console.error("Template de publicité native non trouvée.");
                        }
                    } else {
                        console.error("Conteneur de publicité native non trouvé.");
                    }
                } else if (type === 'video') {
                    try {
                        if (!this.videoPlayer) {
                            console.error('Lecteur vidéo non initialisé.');
                            return;
                        }

                        const mockVastUrl = "https://vast.bliink.io/vp/bouygues/2024/Instream/vague2.xml";

                        this.videoPlayer.ima.changeAdTag(mockVastUrl);

                        this.videoPlayer.src({
                            type: 'video/mp4',
                            src: 'https://video.bliink.io/creative-preview.mp4'
                        });

                        this.videoPlayer.one('loadedmetadata', () => {
                            this.videoPlayer.ima.requestAds();
                        });
                    } catch (error) {
                        console.error('Erreur dans le rendu de la publicité vidéo:', error);
                    }
                }
            }


            renderBanner(bid) {
                const container = document.getElementById(bid.impid);
                if (!container) return;

                const iframe = document.createElement('iframe');
                // Utiliser les dimensions de la réponse
                if (bid.w && bid.h) {
                    iframe.width = bid.w;
                    iframe.height = bid.h;
                }
                iframe.style.border = 'none';
                iframe.setAttribute('sandbox', 'allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation');
                container.innerHTML = '';
                container.appendChild(iframe);

                const html = bid.adm;
                const doc = iframe.contentWindow.document;
                doc.open();
                doc.write(html);
                doc.close();
            }

            renderNative(bid) {
                const container = document.getElementById(bid.impid);
                if (!container) return;

                const nativeData = JSON.parse(bid.adm);
                const template = document.querySelector('.native-ad-template');
                console.log("template", template);
                const content = template.content.cloneNode(true);

                const ad = content.querySelector('.native-ad');
                ad.querySelector('.native-ad-image').src = nativeData.assets.find(a => a.img)?.img?.url || '';
                ad.querySelector('.native-ad-title').textContent = nativeData.assets.find(a => a.title)?.title?.text || '';
                ad.querySelector('.native-ad-desc').textContent = nativeData.assets.find(a => a.data && a.data.type === 2)?.data?.value || '';
                const cta = ad.querySelector('.native-ad-cta');
                cta.textContent = nativeData.assets.find(a => a.data && a.data.type === 12)?.data?.value || 'En savoir plus';
                cta.href = nativeData.link?.url || '#';

                container.innerHTML = '';
                container.appendChild(content);
            }

            renderVideo(bid) {
                const container = document.getElementById(bid.impid);
                if (!container || !this.videoPlayer) return;

                const vastUrl = bid.vastUrl || bid.adm;
                if (!vastUrl) {
                    console.error('No VAST URL or creative found for video ad');
                    return;
                }

                // Si le player n'a pas encore d'instance IMA, on l'initialise
                if (typeof this.videoPlayer.ima === 'function') {
                    this.videoPlayer.ima({
                        id: 'video-player',
                        adTagUrl: vastUrl
                    });
                }

                // On utilise l'instance IMA existante
                this.videoPlayer.ready(() => {
                    if (this.videoPlayer.ima && typeof this.videoPlayer.ima.changeAdTag === 'function') {
                        this.videoPlayer.ima.changeAdTag(vastUrl);
                        this.videoPlayer.ima.requestAds();
                    }
                });
            }

            updateStatus(message, isError = false) {
                const statusPanel = document.getElementById('status-panel');
                const status = document.getElementById('status');

                // Nettoyer le timeout existant
                if (this.statusPanelTimeout) {
                    clearTimeout(this.statusPanelTimeout);
                }

                // Afficher le panel et mettre à jour le message
                statusPanel.classList.remove('fade-out');
                status.textContent = message;
                status.style.color = isError ? '#ff4444' : '#fff';

                // Cacher le panel après 5 secondes si ce n'est pas une erreur
                if (!isError) {
                    this.statusPanelTimeout = setTimeout(() => {
                        statusPanel.classList.add('fade-out');
                    }, 5000);
                }
            }

            displayLatency() {
                const latency = Date.now() - this.initTime;
                document.getElementById('latency').textContent = `${latency}ms`;
            }

            getOS() {
                const userAgent = navigator.userAgent;
                if (userAgent.includes('Mac OS X')) return 'Mac OS X';
                if (userAgent.includes('Windows')) return 'Windows';
                if (userAgent.includes('Linux')) return 'Linux';
                return 'Unknown';
            }

            getOSVersion() {
                const userAgent = navigator.userAgent;
                const macMatch = userAgent.match(/Mac OS X (\d+[._]\d+[._]\d+)/);
                if (macMatch) return macMatch[1].replace(/_/g, '.');
                const windowsMatch = userAgent.match(/Windows NT (\d+\.\d+)/);
                if (windowsMatch) return windowsMatch[1];
                return '';
            }

            addMockResponses(data) {
                // Clone les données existantes
                const mockData = { ...data };
                if (!mockData.seatbid) mockData.seatbid = [];

                // Mock pour Native
                mockData.seatbid.push({
                    bid: [{
                        impid: 'native-ad',
                        price: 3.5,
                        adm: JSON.stringify({
                            ver: "1.2",
                            assets: [
                                {
                                    id: 1,
                                    title: {
                                        text: "Titre de la publicité native"
                                    }
                                },
                                {
                                    id: 2,
                                    img: {
                                        url: "https://placehold.co/1200x627",
                                        w: 1200,
                                        h: 627
                                    }
                                },
                                {
                                    id: 3,
                                    data: {
                                        type: 1,
                                        value: "Description longue de la publicité native de test"
                                    }
                                },
                                {
                                    id: 4,
                                    data: {
                                        type: 2,
                                        value: "Brand"
                                    }
                                },
                                {
                                    id: 5,
                                    data: {
                                        type: 12,
                                        value: "Cliquez ici"
                                    }
                                }
                            ],
                            link: {
                                url: "https://example.com"
                            }
                        })
                    }]
                });

                // Mock pour Video
                mockData.seatbid.push({
                    bid: [{
                        impid: 'video-ad',
                        price: 4.5,
                        vastUrl: "https://pubads.g.doubleclick.net/gampad/ads?iu=/21775744923/external/single_preroll_skippable&sz=640x480&ciu_szs=300x250%2C728x90&gdfp_req=1&output=vast&unviewed_position_start=1&env=vp&impl=s&correlator="
                    }]
                });

                return mockData;
            }
        }

        // Initialisation au chargement de la page
        window.addEventListener('load', () => {
            const prebidTest = new PrebidServerTest();
            prebidTest.init();
        });
    </script>
</body>

</html>